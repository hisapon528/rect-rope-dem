<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>長方形の面積 可視化（ブラウザ版 / CheerpJ）</title>
  <!-- CheerpJ ランタイムを読み込み（公式CDN） -->
  <script src="https://cjrtnc.leaningtech.com/4.2/loader.js"></script>
  <style>
    html,body { height:100%; margin:0; background:#f5f5f5; }
    #wrap { height:100%; display:grid; place-items:center; }
    #mount { width:1100px; height:700px; max-width:98vw; max-height:96vh; }
    .tip { position:fixed; left:12px; bottom:12px; font:14px/1.6 system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Sans", "Noto Sans JP", sans-serif; color:#444; }
    code { background:#eee; padding:2px 4px; border-radius:4px; }
  </style>
</head>
<body>
  <div id="wrap"><div id="mount"></div></div>
  <div class="tip">JAR名は <code>RectFunctionDemo.jar</code> を想定しています。同じ階層に <code>ひも.png</code> も置いてください。</div>
<script>
(async () => {
  const log = (...a) => console.log("[cheerpj]", ...a);
  try {
    log("init...");
    await cheerpjInit();
    cheerpjCreateDisplay(1100, 700, document.getElementById('mount'));
    log("init OK");

    log("HEAD RectFunctionDemo.jar ...");
    const head = await fetch("RectFunctionDemo.jar", { method: "HEAD" });
    log("HEAD status =", head.status);
    if (!head.ok) {
      document.body.insertAdjacentHTML("beforeend",
        `<div style="position:fixed;top:10px;left:10px;background:#fff3cd;border:1px solid #ffeeba;padding:10px;border-radius:8px;color:#856404;">
           JAR が見つかりません（HTTP ${head.status}）。index.html と同じ階層に RectFunctionDemo.jar を置いてください。
         </div>`);
      return;
    }

    log("addClasspath...");
    await cheerpjAddClasspath("RectFunctionDemo.jar");
    log("runMain RectFunctionDemo ...");
    await cheerpjRunMain("RectFunctionDemo", []); // パッケージがあるなら完全修飾名に
    log("runMain OK");
  } catch (e) {
    console.error(e);
    const m = document.createElement('pre');
    m.textContent =
      "起動に失敗しました。\n---- error ----\n" +
      (e && e.message ? e.message : String(e)) +
      "\n--------------\n" +
      "F12→Console もあわせて確認してください。";
    m.style.cssText =
      "position:fixed;top:10px;left:10px;background:#fff3cd;border:1px solid #ffeeba;padding:10px;border-radius:8px;color:#856404;max-width:95vw;white-space:pre-wrap;";
    document.body.appendChild(m);
  }
})();
</script>

</body>
</html>
