<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>HelloSwing デプロイテスト（CheerpJ）</title>
  <!-- CheerpJ ランタイム -->
  <script src="https://cjrtnc.leaningtech.com/4.2/loader.js"></script>
  <style>
    html,body { height:100%; margin:0; background:#f5f5f5; }
    #wrap { height:100%; display:grid; place-items:center; }
    #mount { width:400px; height:200px; max-width:98vw; max-height:96vh; }
    .log { position:fixed; left:12px; top:12px; background:#fff3cd;
           border:1px solid #ffe08a; padding:10px; border-radius:8px;
           color:#7a5c00; white-space:pre-wrap; max-width:60ch; font:13px/1.5 system-ui; }
  </style>
</head>
<body>
  <div id="wrap"><div id="mount"></div></div>
  <pre class="log" id="log"></pre>

  <script>
    (async () => {
      const log = (...a)=>{ const el=document.getElementById('log'); el.textContent += a.join(' ') + '\n'; console.log('[cheerpj]', ...a); };

      try {
        log('CheerpJ init…');
        await cheerpjInit();                                       // ランタイム初期化
        cheerpjCreateDisplay(400, 200, document.getElementById('mount')); // 表示領域
        log('addClasspath HelloSwing.jar …');
        await cheerpjAddClasspath('HelloSwing.jar');               // JAR をクラスパスへ
        log('runMain HelloSwing …');
        await cheerpjRunMain('HelloSwing', []);                    // Main を直接実行
        log('runMain OK');
      } catch (e) {
        log('ERROR:', e && e.message ? e.message : String(e));
        alert('起動に失敗しました。Ctrl+F5 で再読み込み、またはシークレットウィンドウでお試しください。');
      }
    })();
  </script>
</body>
</html>
